<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Glosarium â€“ Kerja Sama Luar Negeri</title>

<!-- Favicon -->
<link rel="icon" href="favicon.ico" type="image/x-icon">

<!-- Fonts & Library -->
<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@700&display=swap" rel="stylesheet">
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
<link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css">
<script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>

<style>
html, body {
  scroll-behavior: smooth;
  -webkit-overflow-scrolling: touch;
}
body {
  font-family: Arial, sans-serif;
  margin: 20px;
  overflow-x: hidden;
  position: relative;
}

/* Container ukuran tabel */
.dt-container {
  max-width: 1100px;
  margin: 0 auto;
}

/* Background crossfade layers */
#bgLayer, #bgLayer2 {
  position: fixed; top:0; left:0;
  width:100%; height:100%;
  background-size: cover;
  background-position: center;
  filter: blur(4px) brightness(0.9);
  z-index: -2;
  transition: opacity 2s ease-in-out;
}
#bgLayer2 {
  z-index: -3;
  opacity: 0;
}

/* Logo kiri atas */
.header-bar {
  display: flex;
  justify-content: flex-start;
  margin-bottom: 15px;
}
.header-bar img {
  width: 160px;
  height: auto;
}

/* Search box */
#searchInput {
  margin-bottom: 15px;
  padding: 8px 12px;
  border-radius: 20px;
  width: 100%;
  max-width: 360px;
  border: 1px solid rgba(255,255,255,0.4);
  background: rgba(255,255,255,0.25);
  backdrop-filter: blur(8px);
  color: #fff; /* teks putih */
}
#searchInput::placeholder {
  color: #fff;
  opacity: 0.8; /* sedikit transparan agar lebih halus */
}
#searchInput:focus {
  border-color: #4f93ce;
  outline: none;
  box-shadow: 0 0 5px rgba(79,147,206,0.6);
}

/* Table glassmorphism */
.table-responsive { overflow-x:auto; }
#glossaryTable {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
  border-radius: 15px;
  background: rgba(255,255,255,0.25);
  backdrop-filter: blur(12px) saturate(180%);
  -webkit-backdrop-filter: blur(12px) saturate(180%);
  border: 1px solid rgba(255,255,255,0.2);
  box-shadow: 0 4px 12px rgba(0,0,0,0.15), 0 2px 6px rgba(0,0,0,0.08);
  overflow: hidden;
}
#glossaryTable thead th {
  background: rgba(79,147,206,0.6);
  color: #fff;
  text-transform: uppercase;
  font-weight: bold;
  position: sticky;
  top: 0;
  z-index: 2;
}
#glossaryTable tbody td {
  background: rgba(255,255,255,0.45);
  backdrop-filter: blur(6px);
  -webkit-backdrop-filter: blur(6px);
  color: #000;
}
#glossaryTable tbody tr:hover td {
  background: rgba(230,240,255,0.55);
}

/* Pagination styling */
.dataTables_paginate {
  text-align: center;
  margin-top: 15px;
}
.dataTables_paginate .paginate_button {
  border-radius: 6px;
  border: 1px solid rgba(79,147,206,0.8);
  padding: 6px 12px;
  margin: 0 3px;
  background: rgba(255,255,255,0.75);
  color: #28527a !important; 
  font-weight: bold;
  cursor: pointer;
  transition: all 0.2s ease;
}
.dataTables_paginate .paginate_button:hover,
.dataTables_paginate .paginate_button.current {
  background: rgba(255,255,255,0.95) !important;
  color: #28527a !important;
  border-color: #28527a;
  box-shadow: 0 2px 5px rgba(0,0,0,0.3);
}
</style>
</head>
<body>

<div id="bgLayer"></div>

<div class="dt-container">
  <div class="header-bar">
    <img src="https://i.imgur.com/8Zh9hjt.png" alt="Pemerintah Provinsi Bali">
  </div>

  <input id="searchInput" type="text" placeholder="Cari istilah atau padanan..." />

  <div class="table-responsive">
    <table id="glossaryTable" class="display">
      <thead>
        <tr>
          <th>Istilah/Frasa (Bahasa Indonesia)</th>
          <th>Padanan Formal (Bahasa Inggris)</th>
          <th>Tanggal Unggah</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>
</div>

<script>
// Background crossfade
const baliImages = [
  "https://i.imgur.com/Xoq5M7D.jpeg",
  "https://i.imgur.com/TdkRewE.jpeg",
  "https://www.kintamani.id/wp-content/uploads/Sunset-di-Pura-Tanah-Lot-Bali.jpg",
  "https://i.imgur.com/Y3iWZGZ.png",
  "https://i.imgur.com/BKsdvcO.jpeg"
];
let bgIndex = 0;
const bgLayer = document.getElementById("bgLayer");
const bgLayer2 = document.createElement('div');
bgLayer2.id = 'bgLayer2';
document.body.appendChild(bgLayer2);
bgLayer.style.backgroundImage = `url('${baliImages[0]}')`;
bgIndex = 1;

function nextBgFade() {
  const nextImage = `url('${baliImages[bgIndex]}')`;
  bgLayer2.style.backgroundImage = nextImage;
  bgLayer2.style.opacity = 1;
  setTimeout(()=>{
    bgLayer.style.backgroundImage = nextImage;
    bgLayer2.style.opacity = 0;
    bgIndex = (bgIndex+1)%baliImages.length;
  },2000);
}
setInterval(nextBgFade,8000);

// Load glosarium
(async function(){
  const sheetCSV="https://docs.google.com/spreadsheets/d/e/2PACX-1vTIDIKfUwmik4T5jZdnHVtD-9y4e7k68d_qp-aHCw9Y8PwgGWejyz8zzRvS3WHHlzSo9tof69ZJK_lN/pub?output=csv";

  function esc(s){return s==null?'':String(s).replaceAll('&','&amp;').replaceAll('<','&lt;').replaceAll('>','&gt;');}

  Papa.parse(sheetCSV,{download:true,header:true,skipEmptyLines:true,
    complete(res){
      const tbody=$("#glossaryTable tbody").empty();
      res.data.forEach(r=>{
        const term = r['Istilah/Frasa (Bahasa Indonesia)'] ?? r['Istilah'] ?? r['Term'] ?? Object.values(r)[0] ?? '';
        const eng  = r['Padanan Formal dalam Bahasa Inggris'] ?? r['Padanan Formal (Bahasa Inggris)'] ?? r['Padanan'] ?? r['English'] ?? Object.values(r)[1] ?? '';
        let dateRaw = r['Tanggal Unggah'] ?? r['Tanggal'] ?? r['Date'] ?? Object.values(r)[2] ?? '';

        let dateText = dateRaw ? String(dateRaw).trim() : '';
        let timestamp = '';
        if(dateText){
          const parts = dateText.match(/(\d{1,2})[\/\-](\d{1,2})[\/\-](\d{2,4})/);
          if(parts){
            let d=parts[1].padStart(2,'0'), m=parts[2].padStart(2,'0'), y=parts[3];
            if(y.length===2) y='20'+y;
            const dt = new Date(`${y}-${m}-${d}`);
            if(!isNaN(dt.getTime())){
              dateText = `${y}-${m}-${d}`;
              timestamp = dt.getTime();
            }
          }
        }

        const tr = $("<tr>");
        tr.append(`<td>${esc(term)}</td>`);
        tr.append(`<td>${esc(eng)}</td>`);
        if(timestamp) tr.append(`<td data-order="${timestamp}">${esc(dateText)}</td>`);
        else tr.append(`<td>${esc(dateText)}</td>`);
        tbody.append(tr);
      });

      if($.fn.dataTable.isDataTable('#glossaryTable')){
        $('#glossaryTable').DataTable().destroy();
      }

      const table = $('#glossaryTable').DataTable({
        dom:'t<"bottom"ip>',
        order:[[0,'asc']],
        columnDefs:[{targets:2,type:'num'}],
        language:{lengthMenu:"Tampilkan _MENU_ entri",info:"Menampilkan _START_ sampai _END_ dari _TOTAL_ entri",infoEmpty:"Tidak ada data tersedia",zeroRecords:"Tidak ditemukan data yang cocok",paginate:{first:"Awal",last:"Akhir",next:"Berikutnya",previous:"Sebelumnya"}},
        pageLength:30
      });

      $('#searchInput').on('keyup',()=>table.search($('#searchInput').val()).draw());
    },
    error(err){ console.error("PapaParse error:",err); alert("Gagal memuat data dari Google Sheets."); }
  });
})();
</script>
</body>
</html>

